## 数字逻辑设计

#### 三大原则

+ **层次化**、**模块化**、**规整化** 

硬件描述语言($\rm Hardware \ Description \ Language, \ HDL$) 是现代数字逻辑设计实践的中心。

分为**组合逻辑**与**时序逻辑**两大内容。



#### 组合电路和时序电路

**组合电路**类比于直觉系统——运算器。

- 输出值是输入值的逻辑函数
- 输入值变化后一段时间后出现新的输出值
- 电路没有记忆功能
- 电路中没有循环反馈和时钟

**时序电路**类比于推理系统——控制器。

+ 输出值是输入值和电路状态的函数
+ 输入变化后新的输出出现在下一个时钟事件或其他事件发生
+ 电路有循环反馈，存在存储元件



#### 模拟量和数字量

**模拟量**是连续的，用精确值表示，但是容易受到干扰。

**数字量**是离散的，可以进行二进制编码，不易受到噪声干扰。



#### 开关函数

**积之和**	$\rm SOP$	$\rm AND$-$\rm OR$​——与或式	**与非门**——圆泡移动法

+ $f(A, B, C) = AB + A'C + AC'$ 

**最小项**    包含全部输入变量的乘积项。**变量用 $1$，补变量用 $0$**. 

+ 对应真值表中值为 $1$ 的行

**最小项范式**    $\begin{aligned} f(A, B, C) &= A'B'C' + A'BC' + ABC' + A'BC + ABC \\ &= m_0 + m_2 + m_6 + m_3 + m_7 \\ &= \sum m(0, 2, 3, 6, 7) \end{aligned}$ 

+ 正逻辑



**和之积**	$\rm POS$	$\rm OR$-$\rm AND$——或与式	**或非门**——圆泡移动法

+ $f(A, B, C) = (A' + B + C) (A + B' + C) (A + B + C')$ 

**最大项**    包含全部输入变量的和项。**变量用 $0$，补变量用 $1$**. 

+ 对应真值表中值为 $0$ 的行

**最大项范式**    $\begin{aligned} f(A + B + C) &= (A + B + C) (A' + B + C) (A' + B + C') \\ &= M_0 \cdot M_4 \cdot M_5 \\ &= \prod M(0, 4, 5)  \end{aligned}$ 

+ 负逻辑



**不确定函数**	含有无关项

无关最小项范式：$f(A, B, C) = \sum m(0, 3, 7) + d(4, 5)$ 

无关最大项范式：$f(A, B, C) = \prod M(1, 2, 6) \cdot D(4, 5)$ 



#### 功耗

**功耗**包括**动态功耗**和**静态功耗**。

动态功耗：$P_{\rm dynamic} = \cfrac{1}{2} CV_{DD}^2 f$ 		静态功耗：$P_{static} = I_{DD} V_{DD}$ 



#### 数字电子计算机

指令：操作码、操作数地址

程序：指令序列（类比：有限状态机）

存储程序：数据与程序以相同的二进制形式存储在可通过地址访问的存储器中。

真空管——晶体管——集成电路——大规模集成电路、微处理器





#### 补与补码

$r$ 进制数 $(N)_r$ 的补为 $[N]_r = r^n - (N)_r$ 

正数的补码是本身。负数的补码是它的补。

$n$ 位补码的表示范围 $2^{n-1}-1 \geq N \geq 2^n$. 



#### 格雷码

生成方式

二进制码的重量是 $1$ 的个数，两个二进制码的距离是两个码不同的位数。



#### 布尔代数

**公理 1  封闭性**    **布尔代数**是一个封闭的代数系统，包含一个至少含有两个元素的集合 $B$ ，在 $B$ 上定义了两个二元运算**与** $\{\cdot\}$ 和**或** $\{+\}$，一个一元运算**非** $\{'\}$ 。
$$
\forall \, a, b \in B, \quad a \cdot b \in B, \quad a+b \in B, \quad a' \in B
$$
**公理 2  交换律**    与运算与或运算满足交换律。
$$
\forall \, a, b \in B, \quad a+b = b + a, \quad a \cdot b = b \cdot a
$$
**公理 3  结合律**    与运算与或运算满足结合律。
$$
\forall \, a, b, c \in B, \quad a+(b+c) = (a+b) + c, \quad a \cdot (b \cdot c) = (a \cdot b) \cdot c
$$
**公理 4  单位元**    $1$ 是与运算的单位元，$0$ 是或运算的单位元。
$$
\forall \, a \in B, \quad a \cdot 1 = a, \quad a+0 = a
$$
**公理 5  分配律**    与运算和或运算互相满足分配律。
$$
\forall \, a, b, c \in B, \quad a+(b \cdot c) = (a + b) \cdot (a + c), \quad a \cdot(b + c) = (a \cdot b) + (a \cdot c)
$$
**公理 6  逆元**    任何元素对于与运算和或运算都有相同的逆元。
$$
\forall \, a \in B, \ \exist \, a' \in B, \quad a + a' = 1, \quad a \cdot a' = 0
$$








**定理 1  幂等律**    与运算和或运算满足幂等律。
$$
X + X = X, \qquad X \cdot X = X
$$
**定理 2  零元**    $0$ 是与运算的零元，$1$ 是或运算的零元。
$$
X + 1 = 1, \qquad X \cdot 0 = 0
$$
**定理 3  逆元的唯一性**    任何元素与它的逆元互为逆元。
$$
(X')' = X
$$
**定理 4  吸收律**    与运算和或运算互相满足吸收律
$$
X + XY = X \qquad \qquad X(X+Y) = X
$$
**定理 5**    										$X + X'Y = X + Y \\
X \cdot (X' + Y) = XY$ 

**定理 6**  				 					  $\ \quad XY + XY' = X \\
(X + Y) (X + Y') = X$

**定理 7  摩根定理**  
$$
(X + Y)' = X' Y', \qquad (XY)' = X' + Y'
$$
推广：$(X + Y + Z + \cdots)' = X' Y' Z' \cdots$ $\quad$ $(XYZ \cdots)' = X' + Y' + Z' + \cdots$ 

 **定理 8  对偶原理**    将一个布尔等式中的 $\cdot$ 和 $+$ 互换，$0$ 和 $1$ 互换，所得结果仍是一个布尔等式。

**定理 9** 							    $(X + Y) (X' + Z) = XZ + X'Y \\
XY + X'Z = (X + Z) (X' + Y)$

**定理 10**    				$\qquad \quad XY + YZ + X'Z = XY + X'Z \\
(X + Y) (Y + Z) (X' + Z) = (X + Y) (X' + Z)$



#### 逻辑门

**与门**：$1$ 通过

**或门**：$0$ 通过

**非门**：取反

**异或门**：$0$ 通过，$1$ 取反





#### 开关

**正开关**：$0$ 开 $1$ 关

**负开关**：$1$ 开 $0$ 关

与非门、或非门 $4$ 个开关，非门 $2$ 个开关



#### 半导体器件

$N$ 型半导体——自由电子	接地

$P$ 型半导体——空穴	通电源

$\rm nMOS$、$\rm pMOS$、$\rm CMOS$ 



#### 规整逻辑——多选器、译码器

#### 多选器——多路选择器

多个输入连接到单一输出

$2^n : 1$ 多选器实现任意 $n$ 变量的函数，输入固定连接 $0$ 或 $1$. 

$2^{n-1}:1$ 多选器实现任意 $n$ 变量的函数，输入连接最后一个变量或它的反。





#### 译码器——多路分配器

$n : 2^n$ 译码器可以实现任意 $n$ 变量的函数

+ 变量作为控制信号，使能信号固定为 $1$，最小项生成器
+ 变量的非作为控制信号，使能信号固定为 $0$，最大项生成器









#### 卡诺图

从相邻度最小的点开始，方形组的维度必须是 $2$ 的幂，无关项在有利化简时被圈入

**最小项化简**、$\rm NAND$ 电路

+ $1$ 化简

**最大项化简**、$\rm NOR$ 电路

+ $0$ 化简



#### 质蕴涵项积覆盖（$\rm SOP$）

+ **蕴含项**：能覆盖一些最小项的积项

+ **质蕴涵项**：不被该函数任何其他蕴涵项覆盖的积项
+ **实质蕴涵项**：至少包含一个最小项不能被其他质蕴涵项覆盖的质蕴涵项
+ **覆盖**：一组可以覆盖函数所有最小项的蕴涵项
+ **最小覆盖**：包含最小的质蕴涵项和最少的符号的覆盖

#### 质蕴涵项和覆盖（$\rm POS$）

+ **蕴含项**：能覆盖一些最大项的和项

+ **质蕴涵项**：不被该函数任何其他蕴涵项覆盖的和项
+ **实质蕴涵项**：至少包含一个最大项不能被其他质蕴涵项覆盖的质蕴涵项
+ **覆盖**：一组可以覆盖函数所有最大项的蕴涵项
+ **最小覆盖**：包含最小的质蕴涵项和最少的符号的覆盖



#### $\rm Q$-$\rm M$ 化简

1. 列出所有最小项（按 $1$ 的个数分组）
2. 穷举生成所有质蕴涵项（从后往前标号）
3. 画出质蕴涵项图表，首先选择实质蕴涵项
4. 找出剩余最小覆盖（$\rm first \ touch$）
	1. 若某一行被其他行覆盖，去掉该行
	2. 若某一列覆盖其他列，去掉该列



#### 冒险（$\rm Hazards$）

由于组合电路中不相同的传输延时导致的不正确的输出

**静态冒险（$\rm glitch$）**：相对正确值的瞬间变化

+ $\rm SOP$ 产生静态 $1$ 冒险：输出从 $1$ 到 $0$ 再到 $1$ 
+ $\rm POS$ 产生静态 $0$ 冒险：输出从 $0$ 到 $1$ 再到 $0$ 

**动态冒险（$\rm bounce$）**：输出在状态变化时变化多次

+ 动态 $0$ 到 $1$ 冒险：输出从 $0$ 到 $1$ 到 $0$ 再到 $1$ 
+ 动态 $1$ 到 $0$ 冒险：输出从 $1$ 到 $0$ 到 $1$ 再到 $0$ 



#### 存储元件

激励输入：每个存储元件有多个输入，能激励或者驱动存储元件进入确定状态的状态的输入，被称为激励输入。

分为**锁存器**和**触发器**两种。



#### 锁存器（$\rm latch$）

只有一半时间用来传播信号，另一半时钟周期输出保持不变

**$\rm R$-$\rm S$ 锁存器** 

+ $\rm R$——复位信号（$\rm Reset$）

+ $\rm S$——置位信号（$\rm Set$）

**$\rm S$-$\rm R$ 锁存器** 

有效脉冲时间要大于等于恢复时间

避免出现追逐/震荡/亚稳态



#### 时钟

**时钟周期**：两个相同跳变的时间间隔

**占空比**：高电平所占时钟周期的比例



#### 触发器（$\rm flip$-$\rm flop$）

时钟周期上升沿前是 $\rm T_{setup}$，上升沿后是 $\rm T_{hold}$，输入信号在 $\rm T_{setup}$ 和 $\rm T_{hold}$ 内不能改变，否则可能会造成亚稳态。

在两个上升沿之间状态稳定

**$\rm D$ 触发器**：消除 $1$ 捕获问题，但没有保持状态

+ **建立时间**：使能信号变化前，激励信号必须保持的一段时间
+ **保持时间**：使能信号变化后，激励信号必须保持的一段时间
+ **最小脉冲宽度**：为保证状态稳定，时钟信号需要的最小脉冲宽度

**$\rm JK$ 触发器**：$\rm S$、$\rm R$ 均为 $1$ 时发生**状态翻转** 

**异步信号**：不用时钟参与就能改变电路状态的激励性，如复位信号 $\rm clr$ 

**同步信号**：必须在时钟参与下才能改变电路状态的激励信号

**$\rm T$ 触发器** 



#### 时序电路的定时方法

保证系统在最严格情况下的正确运行

延迟时间大于保持时间	$\rm T_{pd} + T_p \geq T_h$ 

时钟周期大于建立时间和延迟时间的和	$\rm T_{clock} \geq T_p + T_{pd} + T_{setup}$ 



#### 计数器

$\rm clr$ 清零信号

每一次上升沿加 $1$ 



#### 有限状态机（$\rm FSM$）

状态图、状态转换表、次态输出函数、组合逻辑实现

次态：先态与输入的函数

**$\rm Moore$ 机**：现态的函数

+ 更安全

**$\rm Mealy$ 机**：现态和输入的函数

+ 状态个数较少
+ 对输入的反应更快

**同步 $\rm Mealy$ 机** 

+ 使用寄存器多



#### 状态等价性

1. 对任意的输入序列所得输出序列都相同，则状态等价
2. 若两状态对某一输入得到的输出相同且两状态的下一状态等价，则两状态等价

**等价关系**：自反、对称、传递

###### 完全确定电路的状态化简

+ 观察法
+ 划分法
+ 蕴含表法



#### 划分法

1. 将输出相同的状态分在一个块内，形成 $1$-等价划分
2. 对每个输入，若 $\rm S_i$ 和 $S_j$ 的次态都在同一个 $\rm P_{k-1}$ 的块内，则 $\rm S_i$ 和 $\rm S_j$ 放在 $\rm P_k$ 的同一块内。按照这一方法连续得到 $\rm P_k$, $\rm k = 2, 3, 4, 5, \ldots$ 直到 $\rm P_{k-1} = P_k$. 



#### 蕴含表法

1. 填入空蕴涵表，每个方格填入二者的次态状态对
2. 依次检查，当方格内某一状态对输出不同，打 ×
3. 某一方格内状态对等价或与方格所对应的状态对相同时，对 √
4. 某一方格内状态对不等价时，打 ×
5. 方格不再变化时结束，没有打 × 的方格对应的状态对为等价对
6. 合并