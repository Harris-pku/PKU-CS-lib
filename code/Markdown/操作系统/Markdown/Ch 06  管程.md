## Ch 06  管程

为什么引入管程：

1. 信号量机制不足：编写困难、效率低
2. $\rm Hansen$、$\rm Hoare$ 管程
3. 一种高级同步机制



##### 管程的定义

1. 是一个特殊模块

2. 有一个名字
3. 由关于**共享资源的数据结构**及其在其上的**一组过程组成** 

进程只能通过调用管程中的过程**间接访问**管程中的数据结构



##### 管程要保证什么

**互斥**：管程是**互斥**进入的，由**编译器**保证

**同步**：**设置条件变量**、**等待/唤醒操作**



#### $\rm Hoare$ 管程

管程的入口处设置一个进程等待队列，**入口等待队列** 

管程内设置进程等待队列，称为**紧急等待队列** 



##### 条件变量的实现

**条件变量**——管程内部说明使用的变量，执行 $\rm wait$ 和 $\rm signal$ 操作



##### 管程的应用

管程的实现：

1. 直接构造：效率高
2. 间接构造：用已存在的机制构建



#### $\rm MESA$ 管程

$\rm Hoare$ 有两次额外的进程切换

$\rm Hoare$ 与 $\rm MESA$ 管程的比较

$\rm MESA$ 管程出错比较少



#### 进程间通信机制

为什么需要通信机制：

1. 信号量及管程的不足
2. 多处理器情况下原语失效



















